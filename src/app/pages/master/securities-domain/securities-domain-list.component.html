<div class="container-fluid">
  <app-page-title [title]="CONFIG.breadcrumb.title" [breadcrumbItems]="CONFIG.breadcrumb.items" [infoTitle]="'Giải thích các trường thông tin'">
    <ng-template #pageInfo>
      <ul class="list-unstyled mb-0 small">
        <li class="mb-3">
          <div class="fw-600">DVP3</div>
          <div class="text-muted">Thanh toán ròng cuối ngày giữa tiền và chứng khoán.</div>
        </li>
        <li class="mb-3">
          <div class="fw-600">T+2</div>
          <div class="text-muted">Thanh toán sau 2 ngày làm việc kể từ ngày giao dịch.</div>
        </li>
        <li class="mb-3">
          <div class="fw-600">NET</div>
          <div class="text-muted">Xử lý theo phương thức ròng (gộp nhiều giao dịch).</div>
        </li>
        <li class="mb-3">
          <div class="fw-600">TRAN</div>
          <div class="text-muted">Xử lý theo từng giao dịch (không gộp).</div>
        </li>
        <li class="mb-3">
          <div class="fw-600">Tiền/CK</div>
          <div class="text-muted">Phương thức thanh toán cho tiền và chứng khoán có thể khác nhau.</div>
        </li>
        <li>
          <div class="fw-600">Mặc định</div>
          <div class="text-muted">Xác định miền được ưu tiên khi không chỉ định cụ thể.</div>
        </li>
      </ul>
    </ng-template>
  </app-page-title>

  <div class="bg-white rounded shadow-sm p-3 position-relative">
    <div class="row g-2 align-items-end mb-3">
      <!-- merged inputs into the same row; remove extra wrapper -->
                <div class="col-md-3">
          <label class="form-label fw-bold text-muted">Mã miền</label>
          <input type="text" class="form-control" placeholder="Mã miền" [(ngModel)]="filter.domainCode" (keyup.enter)="onSearch()">
        </div>
        <div class="col-md-4">
          <label class="form-label fw-bold text-muted">Tên miền thanh toán</label>
          <input type="text" class="form-control" placeholder="Tên miền thanh toán" [(ngModel)]="filter.domainName" (keyup.enter)="onSearch()">
        </div>
        
      <div class="col-auto">
        <button class="btn btn-primary" (click)="onSearch()" [disabled]="loading">
          <i class="bx bx-search"></i> Tìm kiếm
        </button>
      </div>
    </div>

    <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

    <div class="table-responsive table-header-primary">
      <table class="table align-middle table-nowrap dt-responsive nowrap w-100">
        <thead>
          <tr>
            <th style="min-width: 220px">Tên miền thanh toán</th>
            <th style="min-width: 140px">Loại hình thanh toán (DVP)</th>
            <th style="min-width: 120px">Chu kỳ thanh toán (T+x)</th>
            <th style="min-width: 180px">Phương thức thanh toán chứng khoán</th>
            <th style="min-width: 180px">Phương thức thanh toán tiền</th>
            <th style="min-width: 140px">Miền mặc định</th>
          </tr>
        </thead>

        <tbody *ngIf="loading">
          <tr *ngFor="let _ of [].constructor(CONFIG.table.skeleton.rows)">
            <td *ngFor="let w of CONFIG.table.skeleton.columns">
              <app-skeleton [width]="w" height="18px"></app-skeleton>
            </td>
          </tr>
        </tbody>

        <tbody *ngIf="!loading && rows.length">
          <tr *ngFor="let r of rows; trackBy: trackByCode">
            <td><div class="fw-500">{{ r.domainName }}</div><div class="text-muted small">{{ r.domainCode }}</div></td>
            <td>{{ r.settlementType }}</td>
            <td>{{ r.settlementCycle }}</td>
            <td>{{ mapSettleMethodLabel(r.secSettlementType) }}</td>
            <td>{{ mapSettleMethodLabel(r.cashSettleType) }}</td>
            <td><i class="bx bx-check text-success" *ngIf="r.isDefault" aria-label="Mặc định"></i><span class="text-muted" *ngIf="!r.isDefault">—</span></td>
          </tr>
        </tbody>
