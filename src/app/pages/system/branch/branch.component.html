<div class="container-fluid">
    <app-page-title
      title="Quản lý chi nhánh"
      [breadcrumbItems]="breadCrumbItems">
    </app-page-title>
  
    <div class="row">
      <div class="col-12">
        <div class="card">
          <div class="card-body">
  
            <!-- ============ FILTER ============ -->
            <div class="group-action row mb-3">
              <div class="group-action__left col-xl-10 col-md-9 col-sm-12">
                <div class="row">
                  <!-- keyword -->
                  <div class="form-group col-4">
                    <input class="form-control"
                           type="text"
                           placeholder="Từ khóa tìm kiếm"
                           [(ngModel)]="searchParams.keyword">
                  </div>
  
                  <!-- status -->
                  <div class="form-group col-4">
                    <select class="form-select"
                            [(ngModel)]="searchParams.status">
                      <option *ngFor="let opt of DEFAULT_STATUS_OPTIONS"
                              [ngValue]="opt.value">
                        {{ opt.label }}
                      </option>
                    </select>
                  </div>
  
                  <!-- search btn -->
                  <div class="form-group col-1">
                    <button class="btn btn-primary waves-effect waves-light"
                            (click)="getItems()">
                      <i class="bx bx-search-alt-2"></i>
                    </button>
                  </div>
                </div>
              </div>
  
              <!-- add new -->
              <div class="group-action__right col-xl-2 col-md-3 col-sm-12">
                <button type="button" class="btn btn-success waves-effect waves-light">
                  <i class="fas fa-plus me-1"></i> Thêm mới
                </button>
              </div>
            </div>
  
            <!-- ============ TABLE ============ -->
            <div class="table-responsive">
              <table class="table align-middle table-nowrap dt-responsive nowrap w-100">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>Mã CN</th>
                    <th>Tên chi nhánh</th>
                    <th>Địa chỉ</th>
                    <th>Khu vực</th>
                    <th>Trạng thái</th>
                    <th>Pending</th>
                    <th>Thao tác</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of items; let i = index">
                    <td>{{ (pagedInfo.pageIndex - 1) * pagedInfo.pageSize + i + 1 }}</td>
                    <td>{{ item.code }}</td>
                    <td>{{ item.name }}</td>
                    <td>{{ item.address }}</td>
                    <td>{{ item.region }}</td>
  
                    <!-- status -->
                    <td>
                      <span class="badge {{ getStatusClass(item.status) }}">
                        {{ getStatusText(item.status) }}
                      </span>
                    </td>
  
                    <!-- pending -->
                    <td>
                      <ng-container *ngIf="item.hasPendingRequest; else okTpl">
                        <span class="badge bg-warning">{{ item.pendingRequestType }}</span>
                      </ng-container>
                      <ng-template #okTpl>—</ng-template>
                    </td>
  
                    <!-- actions -->
                    <td class="action-column">
                      <span class="text-info"><i class="fas fa-eye"></i></span>
                      <span class="text-warning ms-2"><i class="fas fa-pen"></i></span>
                      <span class="text-danger ms-2"><i class="fas fa-trash"></i></span>
                    </td>
                  </tr>
  
                  <tr *ngIf="items.length === 0">
                    <td colspan="8" class="text-center">Không có dữ liệu</td>
                  </tr>
                </tbody>
              </table>
            </div>
  
            <!-- ============ PAGINATION ============ -->
            <div class="table-filter d-flex justify-content-between align-items-center mt-2">
              <ul class="pagination mb-0">
                <li class="page-item"
                    [class.disabled]="pagedInfo.pageIndex === 1">
                  <a class="page-link" (click)="changePage(pagedInfo.pageIndex - 1)">
                    <i class="mdi mdi-chevron-left"></i>
                  </a>
                </li>
  
                <li *ngFor="let _ of [].constructor(pagedInfo.totalPages); let idx = index"
                    class="page-item"
                    [class.active]="pagedInfo.pageIndex === idx + 1">
                  <a class="page-link" (click)="changePage(idx + 1)">
                    {{ idx + 1 }}
                  </a>
                </li>
  
                <li class="page-item"
                    [class.disabled]="pagedInfo.pageIndex === pagedInfo.totalPages">
                  <a class="page-link" (click)="changePage(pagedInfo.pageIndex + 1)">
                    <i class="mdi mdi-chevron-right"></i>
                  </a>
                </li>
              </ul>
  
              <!-- page size -->
              <div class="per-page">
                Hiển thị
                <select class="mx-1"
                        [(ngModel)]="searchParams.pageSize"
                        (change)="changePageSize()">
                  <option *ngFor="let opt of DEFAULT_PER_PAGE_OPTIONS"
                          [ngValue]="opt.value">
                    {{ opt.label }}
                  </option>
                </select>
                / {{ pagedInfo.totalItems }} tổng số bản ghi
              </div>
            </div>
  
          </div>
        </div>
      </div>
    </div>
  </div>
  