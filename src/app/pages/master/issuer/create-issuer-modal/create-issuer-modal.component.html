<!-- Create Issuer Modal -->
<div class="modal fade show d-block" *ngIf="isVisible" tabindex="-1" role="dialog" style="background-color: rgba(0,0,0,0.5);">
  <div class="modal-dialog modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title text-success fw-semibold">
          <i class="fas fa-plus-circle me-2"></i>Thêm mới tổ chức phát hành
        </h5>
        <button type="button" class="btn-close" aria-label="Close" (click)="onCancel()"></button>
      </div>

      <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="needs-validation">
        <div class="modal-body px-4 py-3">
    <div class="row gy-3">
      <!-- Mã TCPH -->
      <div class="col-md-6 position-relative">
        <label class="form-label">Mã TCPH <span class="text-danger">*</span></label>
        <input 
          type="text" 
          class="form-control non-editable-field" 
          formControlName="issuerCode" 
          placeholder="Nhập mã TCPH"
          [readonly]="true"
          [ngClass]="{'is-invalid': isFieldInvalid('issuerCode')}"
          appUpperNoSpace />
        <div *ngIf="isFieldInvalid('issuerCode')" class="invalid-tooltip">
          {{ getFieldError('issuerCode') }}
        </div>
      </div>

      <!-- Tên viết tắt -->
      <div class="col-md-6 position-relative">
        <label class="form-label">Tên viết tắt <span class="text-danger">*</span></label>
        <input 
          type="text" 
          class="form-control" 
          formControlName="shortName" 
          placeholder="Nhập tên viết tắt"
          [ngClass]="{'is-invalid': isFieldInvalid('shortName')}" />
        <div *ngIf="isFieldInvalid('shortName')" class="invalid-tooltip">
          {{ getFieldError('shortName') }}
        </div>
      </div>

      <!-- Tên đầy đủ -->
      <div class="col-md-6 position-relative">
        <label class="form-label">Tên đầy đủ <span class="text-danger">*</span></label>
        <input 
          type="text" 
          class="form-control" 
          formControlName="fullName" 
          placeholder="Nhập tên đầy đủ"
          [ngClass]="{'is-invalid': isFieldInvalid('fullName')}" />
        <div *ngIf="isFieldInvalid('fullName')" class="invalid-tooltip">
          {{ getFieldError('fullName') }}
        </div>
      </div>

      <!-- Ghi chú -->
      <div class="col-md-6 position-relative">
        <label class="form-label">Ghi chú</label>
        <textarea class="form-control" rows="1" formControlName="comment" placeholder="Ghi chú (không bắt buộc)"></textarea>
      </div>

    </div>
  </div>

        <div class="modal-footer border-top-0">
          <button type="button" class="btn btn-outline-secondary me-2" (click)="onCancel()" [disabled]="isSubmitting">
            Hủy
          </button>
          <button 
            type="submit" 
            class="btn btn-success" 
            [disabled]="isSubmitting || userForm.invalid">
            <i class="fas fa-paper-plane me-1" *ngIf="!isSubmitting"></i>
            <span class="spinner-border spinner-border-sm me-1" *ngIf="isSubmitting" role="status" aria-hidden="true"></span>
            {{ isSubmitting ? 'Đang gửi...' : 'Gửi duyệt' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
